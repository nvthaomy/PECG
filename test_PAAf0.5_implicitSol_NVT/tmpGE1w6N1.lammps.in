# LAMMPS INPUT FILE GENERATED BY SIM SUITE
clear

# Initialize simulation box
package omp     5
dimension       3
boundary        p p p 
units           real
atom_style      full

# Set potential styles
pair_style      hybrid/overlay table2 spline 1000 coul/long  2.25000e+01
kspace_style    pppm 1.e-4
bond_style      harmonic

# Read molecule data and set initial velocities
read_data       /home/mnguyen/bin/PECG/test_PAAf0.5_implicitSol_NVT/tmpGE1w6N1.lammps.data 
velocity        all create  1.5014e+05 96155 rot yes dist gaussian

# Assign potentials
pair_coeff      *     *     coul/long
pair_coeff          1     1 table2 /home/mnguyen/bin/PECG/test_PAAf0.5_implicitSol_NVT/tmpGE1w6N1.lammps.pair PairPotential4[0]11[0]
pair_coeff          1     2 table2 /home/mnguyen/bin/PECG/test_PAAf0.5_implicitSol_NVT/tmpGE1w6N1.lammps.pair PairPotential2[0]9[1]
pair_coeff          2     2 table2 /home/mnguyen/bin/PECG/test_PAAf0.5_implicitSol_NVT/tmpGE1w6N1.lammps.pair PairPotential1[0]8[2]
bond_coeff          1  2.9624e+02  3.5000e+00 

special_bonds     lj 1.0 1.0 1.0 coul 0.0 0.0 1.0

variable UExtSin equal 0.592474963246
variable offsetExtSin equal 0.0
variable nperiodExtSin equal 1.0
variable factorExtSin equal 2.0*PI*${nperiodExtSin}/lz
variable sineExtSin atom ${UExtSin}*sin(${factorExtSin}*(x-${offsetExtSin}))
variable cosineExtSin atom ${UExtSin}*${factorExtSin}*cos(${factorExtSin}*(x-${offsetExtSin}))

group atomsInFieldExtSin type 2 4 6 8 10 12
fix UextExtSin atomsInFieldExtSin addforce 0.0 0.0 v_cosineExtSin energy v_sineExtSin
fix_modify UextExtSin energy yes




#Thermostat & time integration
timestep        4.8780e-02 
thermo          10
thermo_style    custom pe temp press
thermo_modify   line multi norm no format float %14.7e

#minimization
minimize        1.e-4 0.0 100 100

#set up integration parameters
fix             timeintegration all nve
fix             thermostat all langevin  1.5014e+05  1.5014e+05  1.0000e-01 59181


#restart thermo
reset_timestep  0
thermo          10
thermo_style    custom pe temp press
thermo_modify   line multi norm no format float %14.7e
variable PRESS equal press
variable STEP equal step

#run equilibration
run             2000

#restart thermo
reset_timestep  0
thermo          10
thermo_style    custom pe temp press
thermo_modify   line multi norm no format float %14.7e

#setup trajectory output
dump            myDump all custom 10 /home/mnguyen/bin/PECG/test_PAAf0.5_implicitSol_NVT/tmpGE1w6N1.trj.lammpstrj id type x y z mol
dump_modify     myDump element A- A
dump_modify     myDump sort id
dump_modify     myDump format line  "%d %d %14.7e %14.7e %14.7e %d"

#run production
run             2000
